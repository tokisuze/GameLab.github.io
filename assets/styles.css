@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

:root{
  --bg1:#0f1216; --bg2:#0b0e12; --panel:#151a1f; --card:#1b2027;
  --text:#e7eef8; --muted:#a7b3c5;
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  color:var(--text);
  font-family:'Inter',system-ui,Segoe UI,Roboto,Arial;
}

.container{ width:min(1200px,94vw); margin:0 auto; padding:22px 0; }

/* Header */
.header{
  position:sticky; top:0; z-index:10;
  background:rgba(15,18,22,.85);
  backdrop-filter:blur(6px);
  border-bottom:1px solid rgba(255,255,255,.06);
}
.header-inner{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; padding:12px 0; }
.brand{ font-weight:800; }
.spacer{ flex:1; }

.btn{
  background:var(--panel); color:var(--text);
  border:1px solid rgba(255,255,255,.12);
  padding:10px 14px; border-radius:10px;
  cursor:pointer; text-decoration:none;
}
.btn:hover{ filter:brightness(1.07); }

/* Cards grid */
.grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:18px; margin-top:16px; }
@media (max-width:980px){ .grid{ grid-template-columns:repeat(2,1fr); } }
@media (max-width:640px){ .grid{ grid-template-columns:1fr; } }

.card{
  background:var(--card);
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px;
  padding:14px;
  display:flex; gap:8px; flex-direction:column;
  transition:transform .12s, filter .12s;
}
.card:hover{ transform:translateY(-2px); filter:brightness(1.03); }
.card h3{ margin:0; font-size:18px; }
.card p{ margin:0; color:var(--muted); font-size:14px; }
.card .actions{ margin-top:auto; display:flex; gap:10px; }

.footer{
  color:var(--muted); font-size:12px; text-align:center;
  padding:16px 0; border-top:1px solid rgba(255,255,255,.06);
  margin-top:22px;
}

/* HUD banner */
#armedBanner{
  position:fixed; left:50%; top:12px; transform:translateX(-50%);
  padding:6px 10px; border-radius:8px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(0,0,0,.6); color:#fff;
  font-size:12px; z-index:20; display:none;
}

/* Music status pill (оставил для статусов) */
#musicStatus{
  position:fixed; right:14px; bottom:16px; z-index:30;
  background:rgba(0,0,0,.6); color:#fff;
  padding:6px 10px; border-radius:999px;
  border:1px solid rgba(255,255,255,.15);
  font-size:12px; opacity:0; transition:opacity .25s;
}
#musicStatus.show{ opacity:1; }

/* Armed overlay + crosshair */
#armedOverlay{ position:fixed; inset:0; pointer-events:none; display:none; z-index:25; }
#cross{
  position:absolute; left:50%; top:50%;
  width:16px; height:16px; pointer-events:none;
  transform:translate(-50%,-50%); border-radius:50%;
  box-shadow:0 0 0 1px rgba(255,255,255,.3),
             inset 0 0 0 1px rgba(255,255,255,.25);
  transition: opacity .2s;
}
#cross::before,#cross::after{
  content:""; position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  width:2px; height:18px; background:rgba(255,255,255,.7); border-radius:2px;
}
#cross::after{ transform:translate(-50%,-50%) rotate(90deg); }
#cross.target{
  box-shadow:0 0 0 1px rgba(255,52,52,.5),
             inset 0 0 0 1px rgba(255,52,52,.35);
}

/* Hit effects */
.hitflash{
  position:fixed; width:14px; height:14px; border-radius:50%;
  pointer-events:none;
  background:radial-gradient(rgba(255,255,200,.9),rgba(255,120,0,.25),transparent 60%);
  mix-blend-mode:screen; z-index:26;
  transform:translate(-50%,-50%); animation:hf .12s ease-out forwards;
}
@keyframes hf{ to{ opacity:0; transform:translate(-50%,-50%) scale(1.5);} }

.broken{ filter:grayscale(.9) brightness(.8); opacity:.6; pointer-events:none; }
.broken-text{ opacity:.45; text-decoration:line-through; }
.hit{ outline:1px solid rgba(255,180,0,.6); outline-offset:2px; }

/* Mystery wobble */
.wobble .card{ animation:wob .6s ease-in-out infinite alternate; }
@keyframes wob{ from{ transform:translateY(-1px) rotate(-.2deg);} to{ transform:translateY(1px) rotate(.2deg);} }

/* ===== DOOM HUD ===== */
#armedOverlay .hud{
  position:absolute; left:50%; bottom:0; transform:translateX(-50%);
  pointer-events:none; z-index:25;
  image-rendering: pixelated;
  width:min(90vw, 920px); max-width:920px; /* подгони под свои ассеты */
}
#armedOverlay .hud.fire{ display:none; }
/* если нужно приподнять вспышку над панелью:
   #armedOverlay .hud.fire{ bottom:40px; } */

#discoBall{
  position:fixed; top:-220px; left:50%; transform:translateX(-50%);
  width:140px; opacity:0; pointer-events:none; z-index:9999;
  filter: drop-shadow(0 10px 24px rgba(0,0,0,.5));
  transition: top 1s cubic-bezier(.2,.9,.2,1), opacity .6s;
}
body.disco #discoBall{ top:72px; opacity:1; }


/* фон под картинку кота-диджея */
body.disco{
  --bg-url: url('assets/dj_cat.jpg'); /* ← поставь свой путь при желании */
  background-image: var(--bg-url), radial-gradient(1000px 600px at 50% 10%, rgba(255,255,255,.06), transparent 60%);
  background-size: cover, auto;
  background-attachment: fixed;
  background-position: center top;
}


/* «танец» только для кнопок в верхней панели, остальное не трогаем */
.toolbar .btn{ transition: transform .12s ease; }
body.disco .toolbar .btn{
  animation: disco-dance var(--beat,.5s) infinite ease-in-out;
}
body.disco .toolbar .btn:nth-child(odd){ animation-delay: calc(var(--beat)/2); }


@keyframes disco-dance{
  0%   { transform: translateY(0) rotate(0deg) }
  25%  { transform: translateY(-4px) rotate(-2deg) scale(1.02) }
  50%  { transform: translateY(0) rotate(0deg) }
  75%  { transform: translateY(-4px) rotate(2deg)  scale(1.02) }
  100% { transform: translateY(0) rotate(0deg) }
}

/* === DISCO BACKDROP (фикс слоёв) === */
body{ position: relative; }                /* создаём стек для z-index */


body.disco{ background-color:#000; }       /* подложка, можно оставить */


body.disco::before{
  content:"";
  position:fixed;
  inset:0;
  z-index:0;                               /* было -1 — из-за этого и не видно */
  background: url("assets/dj_cat.jpg") center / cover no-repeat;  /* твоя картинка */
  /* запасной вариант на всякий случай:
  /* background: url("https://picsum.photos/1600/900") center/cover no-repeat; */
  opacity:1;
  pointer-events:none;
}


/* поднимаем основной контент над фоном */
.header, .wrap, .footer { position: relative; z-index: 1; }

/* ==== DISCO PATCH v2: прозрачные кнопки + удар в бас ==== */
body.disco .toolbar .btn{
  background: transparent !important;
  border-color: rgba(255,255,255,.25) !important;
  color: #fff !important;
  box-shadow: 0 0 0 rgba(0,0,0,0);
  backdrop-filter: blur(2px);
  /* амплитуда с JS: 0..1 */
  --amp: 0;
  transform-origin: center bottom;
  /* базовый подпрыг для «ридма», длительность = var(--beat) */
  animation: disco-bounce var(--beat, .5s) infinite ease-in-out;
}

/* чуть разная фаза, чтобы не синхронно */
body.disco .toolbar .btn:nth-child(odd){ animation-delay: calc(var(--beat)/2); }

@keyframes disco-bounce{
  0%   { transform: translateY(0) rotate(0deg) scale(1); }
  20%  { transform: translateY(-4px) rotate(-2deg) scale(1.02); }
  50%  { transform: translateY(0) rotate(0deg) }
  80%  { transform: translateY(-3px) rotate(2deg)  scale(1.01); }
  100% { transform: translateY(0) rotate(0deg) }
}

/* ДОБАВИТЕЛЬНО: мгновенный «удар» от амплитуды (из JS) — сильнее трясём */
body.disco .toolbar .btn{
  /* умножаем амплитуду на силу — можно увеличить 10→14 для ещё мощнее */
  --kick: clamp(0, var(--amp), 1);
  /* суммарный трансформ = базовый bounce из keyframes + «всплеск» от баса */
  /* современные браузеры складывают трансформы: используем filter как вспышку */
  filter: drop-shadow(0 0 calc(8px * var(--kick)) rgba(255,255,255,.35));
  /* «дрожь» в удар: добавка к transform через CSS vars невозможна, поэтому основной толчок даёт JS (ниже) */
}

/* ==== DISCO PATCH v3 (сильнее и прозрачные кнопки) ==== */
body.disco #armedToggle,
body.disco #mysteryBtn {
  background: transparent !important;
  color: #fff !important;
  border-color: rgba(255,255,255,.35) !important;
  box-shadow: none !important;
  backdrop-filter: blur(2px);
}


/* если кнопки не внутри .toolbar — всё равно сработает по ID */
body.disco .toolbar .btn {
  /* базовый подпрыг по BPM */
  animation: disco-bounce var(--beat, .5s) infinite ease-in-out !important;
}


@keyframes disco-bounce{
  0%   { transform: translateY(0) rotate(0deg) }
  20%  { transform: translateY(-6px) rotate(-3deg) scale(1.03) }
  50%  { transform: translateY(0) rotate(0deg) }
  80%  { transform: translateY(-5px) rotate(3deg)  scale(1.02) }
  100% { transform: translateY(0) rotate(0deg) }
}


/* переменная амплитуды приходит из JS: 0..1 — усиливаем свечение */
body.disco #armedToggle,
body.disco #mysteryBtn {
  --amp: 0;
  filter: drop-shadow(0 0 calc(14px * var(--amp)) rgba(255,255,255,.45));
}
